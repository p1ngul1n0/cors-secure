(this["webpackJsonpcors-secure"]=this["webpackJsonpcors-secure"]||[]).push([[0],{14:function(e,t,s){},17:function(e,t,s){"use strict";s.r(t);var c=s(1),r=s.n(c),n=s(8),a=s.n(n),l=s(2),i=(s(14),s(0)),o=function(){return Object(i.jsxs)("nav",{className:"header",children:[Object(i.jsx)("a",{href:"/",children:Object(i.jsx)("h2",{children:"CORS-Secure"})}),Object(i.jsxs)("ul",{className:"menu",children:[Object(i.jsx)("li",{children:Object(i.jsx)("a",{href:"/",children:"OWASP"})}),Object(i.jsx)("li",{children:Object(i.jsx)("a",{href:"/",children:"PortSwigger"})})]})]})},j=function(e){var t=e.https,s=e.setHttps,c=e.credentials,r=e.setCredentials;return Object(i.jsxs)("div",{className:"request-options",children:[Object(i.jsx)("h3",{children:"Options"}),Object(i.jsxs)("div",{children:[Object(i.jsx)("input",{type:"checkbox",value:"https",checked:t,onChange:function(e){var t=e.target;s(t.checked)}}),Object(i.jsx)("label",{children:"HTTPS"})]}),Object(i.jsxs)("div",{children:[Object(i.jsx)("input",{type:"checkbox",value:"include",checked:c,onChange:function(e){e.target.checked?r(!0):r(!1)}}),Object(i.jsx)("label",{children:"Credentials"})]})]})},u=s(4),h=function(e){var t=e.https,s=e.setRequest,c=e.request,n=r.a.useRef();return r.a.useEffect((function(){t&&null!==c?s(Object(u.a)(Object(u.a)({},c),{},{url:c.url.replace("http","https")})):t||null===c||s(Object(u.a)(Object(u.a)({},c),{},{url:c.url.replace("https","http")}))}),[t]),Object(i.jsxs)("div",{className:"request-input",children:[Object(i.jsx)("h2",{children:"Request"}),Object(i.jsx)("textarea",{ref:n,onBlur:function(e){var c,r,a={},l=n.current.value,i=l.split("\n"),o=i[0].split(" /")[0],j=i[0].split(" ")[1];delete i[0],i.map((function(e){return a[e.split(": ")[0]]=e.split(": ")[1]})),c=t?"https://"+a.Host+j:"http://"+a.Host+j,r="POST"===o||"PUT"===o?l.split("\n\n")[1]:null,s({url:c,method:o,headers:a,body:r})},spellCheck:"false",placeholder:"Paste the request here..."})]})},d=s(3),b=s.n(d),p=s(5),O=function(e){var t=e.request,s=e.setError,c=e.setResponse,r=e.setLoading,n=e.credentials;function a(){return(a=Object(p.a)(b.a.mark((function e(a){var l;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=16;break}if(r(!0),s(null),!n){e.next=9;break}return e.next=6,fetch(t.url,{method:t.method,headers:t.headers,body:t.body,mode:"cors",credentials:"include"}).catch((function(e){s(e.message)}));case 6:l=e.sent,e.next=12;break;case 9:return e.next=11,fetch(t.url,{method:t.method,headers:t.headers,body:t.body,mode:"cors"}).catch((function(e){s(e.message)}));case 11:l=e.sent;case 12:c(l),r(!1),e.next=17;break;case 16:s("Please fill the request input correctly.");case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(i.jsx)("div",{className:"button-start",children:Object(i.jsx)("button",{onClick:function(e){return a.apply(this,arguments)},children:Object(i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"50",height:"50",fill:"#252422",viewBox:"0 0 16 16",children:Object(i.jsx)("path",{d:"m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393z"})})})})},x=s(9),f=function(e){var t=e.response,s=r.a.useState(""),c=Object(l.a)(s,2),n=c[0],a=c[1];return r.a.useEffect((function(){if(t){var e="";e=e.concat("HTTP/1.1 ".concat(t.status," ").concat(t.statusText,"\n"));var s,c=Object(x.a)(t.headers.entries());try{for(c.s();!(s=c.n()).done;){var r=s.value;e=e.concat("".concat(r[0].charAt(0).toUpperCase()+r[0].slice(1),": ").concat(r[1],"\n"))}}catch(n){c.e(n)}finally{c.f()}t.text().then(function(){var t=Object(p.a)(b.a.mark((function t(s){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=e.concat("\n\n".concat(s)),a(e);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}),[t]),Object(i.jsxs)("div",{className:"response-input",children:[Object(i.jsx)("h2",{children:"Response - Exploitable"}),Object(i.jsx)("textarea",{readOnly:!0,value:n})]})},v=function(){return Object(i.jsx)("div",{className:"loader-wrapper",children:Object(i.jsx)("div",{className:"loader"})})},m=function(e){var t=e.error;return Object(i.jsxs)("div",{className:"error-panel",children:[Object(i.jsx)("h2",{children:"Not exploitable"}),Object(i.jsx)("p",{children:"An error occurred while fetching the CORS request, verify the browser console to check for any CORS related errors."}),Object(i.jsx)("p",{children:"The following error occured:"}),Object(i.jsx)("div",{className:"error-wrapper",children:Object(i.jsx)("div",{className:"error",children:t})})]})},g=function(){return Object(i.jsxs)("div",{className:"message-panel",children:[Object(i.jsx)("h2",{children:"CORS Test"}),Object(i.jsx)("div",{className:"message",children:Object(i.jsx)("p",{children:"Paste a request and hit the start button to test if the API has a overly permissive CORS policy."})})]})};var y=function(){var e=r.a.useState(null),t=Object(l.a)(e,2),s=t[0],c=t[1],n=r.a.useState(!1),a=Object(l.a)(n,2),u=a[0],d=a[1],b=r.a.useState(!1),p=Object(l.a)(b,2),x=p[0],y=p[1],w=r.a.useState(null),S=Object(l.a)(w,2),k=S[0],N=S[1],q=r.a.useState(null),C=Object(l.a)(q,2),R=C[0],P=C[1],T=r.a.useState(!1),E=Object(l.a)(T,2),H=E[0],A=E[1];return Object(i.jsxs)("div",{children:[Object(i.jsx)(o,{}),Object(i.jsxs)("div",{className:"content",children:[Object(i.jsx)(j,{https:u,setHttps:d,credentials:x,setCredentials:y}),Object(i.jsx)(h,{https:u,setRequest:c,request:s}),Object(i.jsx)(O,{request:s,setError:N,setResponse:P,setLoading:A,credentials:x}),H?Object(i.jsx)(v,{}):k?Object(i.jsx)(m,{error:k}):R?Object(i.jsx)(f,{response:R}):Object(i.jsx)(g,{})]})]})};a.a.render(Object(i.jsx)(r.a.StrictMode,{children:Object(i.jsx)(y,{})}),document.getElementById("root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.8a759213.chunk.js.map