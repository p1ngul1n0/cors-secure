(this["webpackJsonpcors-secure"]=this["webpackJsonpcors-secure"]||[]).push([[0],{14:function(e,t,s){},17:function(e,t,s){"use strict";s.r(t);var r=s(1),c=s.n(r),n=s(8),a=s.n(n),l=s(2),i=(s(14),s(0)),o=function(){return Object(i.jsxs)("nav",{className:"header",children:[Object(i.jsx)("a",{href:"/",children:Object(i.jsx)("h2",{children:"CORS-Secure"})}),Object(i.jsxs)("ul",{className:"menu",children:[Object(i.jsx)("li",{children:Object(i.jsx)("a",{href:"/",children:"OWASP"})}),Object(i.jsx)("li",{children:Object(i.jsx)("a",{href:"/",children:"PortSwigger"})})]})]})},j=function(e){var t=e.https,s=e.setHttps;return Object(i.jsxs)("div",{className:"request-options",children:[Object(i.jsx)("h3",{children:"Options"}),Object(i.jsx)("input",{type:"checkbox",value:"https",checked:t,onChange:function(e){var t=e.target;s(t.checked)}}),Object(i.jsx)("label",{children:"HTTPS"})]})},u=s(4),h=function(e){var t=e.https,s=e.setRequest,r=e.request,n=c.a.useRef();return c.a.useEffect((function(){t&&null!==r?s(Object(u.a)(Object(u.a)({},r),{},{url:r.url.replace("http","https")})):t||null===r||s(Object(u.a)(Object(u.a)({},r),{},{url:r.url.replace("https","http")}))}),[t]),Object(i.jsxs)("div",{className:"request-input",children:[Object(i.jsx)("h2",{children:"Request"}),Object(i.jsx)("textarea",{ref:n,onBlur:function(e){var r,c,a={},l=n.current.value,i=l.split("\n"),o=i[0].split(" /")[0],j=i[0].split(" ")[1];delete i[0],i.map((function(e){return a[e.split(": ")[0]]=e.split(": ")[1]})),r=t?"https://"+a.Host+j:"http://"+a.Host+j,c="POST"===o||"PUT"===o?l.split("\n\n")[1]:null,s({url:r,method:o,headers:a,body:c})},spellCheck:"false",placeholder:"Paste the request here..."})]})},d=s(3),b=s.n(d),p=s(5),O=function(e){var t=e.request,s=e.setError,r=e.setResponse,c=e.setLoading;function n(){return(n=Object(p.a)(b.a.mark((function e(n){var a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=10;break}return c(!0),s(null),e.next=5,fetch(t.url,{method:t.method,headers:t.headers,body:t.body,mode:"cors"}).catch((function(e){s(e.message)}));case 5:a=e.sent,r(a),c(!1),e.next=11;break;case 10:s("Please fill the request input correctly.");case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(i.jsx)("div",{className:"button-start",children:Object(i.jsx)("button",{onClick:function(e){return n.apply(this,arguments)},children:Object(i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"50",height:"50",fill:"#252422",viewBox:"0 0 16 16",children:Object(i.jsx)("path",{d:"m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393z"})})})})},x=s(9),f=function(e){var t=e.response,s=c.a.useState(""),r=Object(l.a)(s,2),n=r[0],a=r[1];return c.a.useEffect((function(){if(t){var e="";e=e.concat("HTTP/1.1 ".concat(t.status," ").concat(t.statusText,"\n"));var s,r=Object(x.a)(t.headers.entries());try{for(r.s();!(s=r.n()).done;){var c=s.value;e=e.concat("".concat(c[0].charAt(0).toUpperCase()+c[0].slice(1),": ").concat(c[1],"\n"))}}catch(n){r.e(n)}finally{r.f()}t.text().then(function(){var t=Object(p.a)(b.a.mark((function t(s){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=e.concat("\n\n".concat(s)),a(e);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}),[t]),Object(i.jsxs)("div",{className:"response-input",children:[Object(i.jsx)("h2",{children:"Response - Exploitable"}),Object(i.jsx)("textarea",{readOnly:!0,value:n})]})},v=function(){return Object(i.jsx)("div",{className:"loader-wrapper",children:Object(i.jsx)("div",{className:"loader"})})},m=function(e){var t=e.error;return Object(i.jsxs)("div",{className:"error-panel",children:[Object(i.jsx)("h2",{children:"Not exploitable"}),Object(i.jsx)("p",{children:"An error occurred while fetching the CORS request, verify the browser console to check for any CORS related errors."}),Object(i.jsx)("p",{children:"The following error occured:"}),Object(i.jsx)("div",{className:"error-wrapper",children:Object(i.jsx)("div",{className:"error",children:t})})]})},w=function(){return Object(i.jsxs)("div",{className:"message-panel",children:[Object(i.jsx)("h2",{children:"CORS Test"}),Object(i.jsx)("div",{className:"message",children:Object(i.jsx)("p",{children:"Paste a request and hit the start button to test if the API has a overly permissive CORS policy."})})]})};var S=function(){var e=c.a.useState(null),t=Object(l.a)(e,2),s=t[0],r=t[1],n=c.a.useState(!1),a=Object(l.a)(n,2),u=a[0],d=a[1],b=c.a.useState(null),p=Object(l.a)(b,2),x=p[0],S=p[1],g=c.a.useState(null),y=Object(l.a)(g,2),N=y[0],q=y[1],k=c.a.useState(!1),R=Object(l.a)(k,2),P=R[0],C=R[1];return Object(i.jsxs)("div",{children:[Object(i.jsx)(o,{}),Object(i.jsxs)("div",{className:"content",children:[Object(i.jsx)(j,{https:u,setHttps:d}),Object(i.jsx)(h,{https:u,setRequest:r,request:s}),Object(i.jsx)(O,{request:s,setError:S,setResponse:q,setLoading:C}),P?Object(i.jsx)(v,{}):x?Object(i.jsx)(m,{error:x}):N?Object(i.jsx)(f,{response:N}):Object(i.jsx)(w,{})]})]})};a.a.render(Object(i.jsx)(c.a.StrictMode,{children:Object(i.jsx)(S,{})}),document.getElementById("root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.df09cc24.chunk.js.map